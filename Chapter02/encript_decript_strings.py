# ------------------------------------------------------------
# 対称鍵暗号方式（Fernet）を用いた文字列の暗号化・復号化デモ
# ------------------------------------------------------------
from cryptography.fernet import Fernet

# ------------------------------------------------------------
# 暗号化対象データ
# ------------------------------------------------------------
title = "Simulation Modeling with Python"

# ------------------------------------------------------------
# 秘密鍵の生成
# ------------------------------------------------------------
# Fernet.generate_key() は 32バイトの安全な鍵（Base64エンコード）を生成する
secret_key = Fernet.generate_key()

# 生成した鍵からFernetオブジェクトを作成
fernet_obj = Fernet(secret_key)

# ------------------------------------------------------------
# データの暗号化
# ------------------------------------------------------------
# 文字列は暗号化前にバイト列に変換（encode()）
enc_title = fernet_obj.encrypt(title.encode())

# 結果を出力
print("My last book title  = ", title)
print("Title encrypted     = ", enc_title)

# ------------------------------------------------------------
# データの復号化
# ------------------------------------------------------------
# decrypt() に暗号化データ（bytes型）を渡すと、元のバイト列が返る
# decode() を使って再び文字列に戻す
dec_title = fernet_obj.decrypt(enc_title).decode()

print("Title decrypted     = ", dec_title)
